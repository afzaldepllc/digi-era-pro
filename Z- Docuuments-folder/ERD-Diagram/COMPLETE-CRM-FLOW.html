<!DOCTYPE html>
<html>

<head>
    <title>Complete CRM Flow Diagram</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            theme: 'default',
            startOnLoad: true,
            flowchart: {
                nodeSpacing: 50,
                rankSpacing: 20,
                padding: 10
            }
        });
    </script>
    <style>
        .mermaid {
            margin: 0;
            padding: 10px;
        }
        .mermaid svg {
            width: 100%;
            height: auto;
        }
    </style>
</head>

<body style="background-color: white;">
    <div class="mermaid">
flowchart TD
    subgraph LEAD_GEN["üéØ LEAD GENERATION"]
        direction TB
        SA["Sales Agent<br/>Creates Lead<br/>Client Basic Info + Project Basic Info<br/>Status: Active/Inactive"]
        LEAD_DB["Leads Collection<br/>Store Lead Data"]
        LEAD_PAGE["Leads Page<br/>View Leads with Statuses<br/>Active, Inactive, Qualified, Unqualified"]
        EDIT_LEAD["Edit Lead Page<br/>Change Status to Qualified<br/>(Active/Inactive/Qualified enabled if not qualified)"]
    end

    subgraph QUALIFICATION["‚úÖ QUALIFICATION"]
        direction TB
        QUAL_CONF["Confirm Qualification<br/>Status -> Qualified"]
        CREATE_CLIENT["Create Client User<br/>In Users Collection<br/>Role: Client<br/>Copy Lead Data<br/>Status: Qualified<br/>Navigate to Client Edit Page"]
        CLIENT_DB["Users Collection<br/>Client Data with Role"]
    end

    subgraph CLIENT_MANAGEMENT["üë§ CLIENT MANAGEMENT"]
        direction TB
        CLIENT_UI["Client UI<br/>Separate UI for Clients<br/>Filter from Users Collection<br/>Statuses: Active, Inactive, Qualified, Unqualified<br/>Optional Password for Login"]
        CLIENT_EDIT["Client Edit Page<br/>Update Status<br/>If Unqualified: Update Lead to Unqualified<br/>Notify Sales Team"]
        NOTIFY_SALES["Notification to Sales Team<br/>Unqualified Reason"]
    end

    subgraph PROJECT_CREATION["üìã PROJECT CREATION"]
        direction TB
        ADD_PROJECT["Add Project<br/>From Client Page<br/>Prefilled Client Data<br/>Add Project Fields<br/>Save Project"]
        PROJECT_DB["Projects Collection<br/>Store Project Data"]
        EDIT_PROJECT["Edit Project Page<br/>Support Team Categorizes Project<br/>Assign to Multiple Departments"]
        APPROVE_PROJECT["Department Manager<br/>Approves Categorization"]
    end

    subgraph TASK_CREATION["‚öôÔ∏è TASK & SUB-TASK CREATION"]
        direction TB
        CREATE_TASK["Support Team / Department Lead<br/>Create Task<br/>Assign to One Department<br/>Project Title + Department"]
        TASK_DB["Tasks Collection<br/>Store Tasks"]
        SUB_TASK["Department Lead<br/>Divide Task into Sub-Tasks<br/>Assign to Team Members"]
        SUB_TASK_DB["Sub-Tasks<br/>Store Sub-Tasks"]
    end

    subgraph EXECUTION["üöÄ EXECUTION"]
        direction TB
        TEAM_LEAD["Team Lead<br/>Assign Tasks/Sub-Tasks<br/>Monitor Progress"]
        TEAM_MEMBER["Team Member<br/>Work on Tasks<br/>Update Status: Pending, Completed"]
        UPDATE_STATUS["Update Task/Sub-Task Status"]
    end

    SA --> LEAD_DB
    LEAD_DB --> LEAD_PAGE
    LEAD_PAGE --> EDIT_LEAD
    EDIT_LEAD --> QUAL_CONF
    QUAL_CONF --> CREATE_CLIENT
    CREATE_CLIENT --> CLIENT_DB
    CLIENT_DB --> CLIENT_UI
    CLIENT_UI --> CLIENT_EDIT
    CLIENT_EDIT --> NOTIFY_SALES
    NOTIFY_SALES --> LEAD_PAGE
    CLIENT_EDIT --> ADD_PROJECT
    ADD_PROJECT --> PROJECT_DB
    PROJECT_DB --> EDIT_PROJECT
    EDIT_PROJECT --> APPROVE_PROJECT
    APPROVE_PROJECT --> CREATE_TASK
    CREATE_TASK --> TASK_DB
    TASK_DB --> SUB_TASK
    SUB_TASK --> SUB_TASK_DB
    SUB_TASK_DB --> TEAM_LEAD
    TEAM_LEAD --> TEAM_MEMBER
    TEAM_MEMBER --> UPDATE_STATUS
    UPDATE_STATUS --> TEAM_LEAD

    classDef leadStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef qualStyle fill:#e8f5e9,stroke:#388e3c,stroke-width:2px
    classDef clientStyle fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef projectStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef taskStyle fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef execStyle fill:#efebe9,stroke:#5d4037,stroke-width:2px

    class SA,LEAD_DB,LEAD_PAGE,EDIT_LEAD leadStyle
    class QUAL_CONF,CREATE_CLIENT,CLIENT_DB qualStyle
    class CLIENT_UI,CLIENT_EDIT,NOTIFY_SALES clientStyle
    class ADD_PROJECT,PROJECT_DB,EDIT_PROJECT,APPROVE_PROJECT projectStyle
    class CREATE_TASK,TASK_DB,SUB_TASK,SUB_TASK_DB taskStyle
    class TEAM_LEAD,TEAM_MEMBER,UPDATE_STATUS execStyle
    </div>
</body>

</html>